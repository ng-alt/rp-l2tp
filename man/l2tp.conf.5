.\" $Id: l2tp.conf.5,v 1.3 2002/09/30 20:20:28 dskoll Exp $ 
.\" LIC: GPL
.TH L2TP.CONF 5 "11 March 2002"
.\""
.UC 4
.SH NAME
l2tp.conf \- L2TP configuration file

.SH DESCRIPTION
\fBl2tpd\fR is a user-space L2TP daemon.  L2TP is the Layer Two
Tunneling Protocol described in RFC 2661.  It allows you to tunnel
PPP sessions over a network or transport protocol (in this case, UDP.)
The file \fB/etc/l2tp/l2tp.conf\fR is the configuration file for the
daemon.

Each line in the file takes one of the following forms:

.TP
\fBo\fR # \fIcomment\fR
A line beginning with a pound sign is ignored.

.TP
\fBo\fR global
The keyword \fBglobal\fR marks the start of the global configuration section.

.TP
\fBo\fR section \fIsec_name\fR
The keyword \fBsection\fR marks the start of configuration options for a
particular section.  The section \fIpeer\fR is built-in and allows you
to specify options relating to a particular L2TP peer.  Other sections
may be present, depending on which handlers have been dynamically-loaded.

.TP
\fBo\fR \fIoption\fR \fIvalue\fR
All other lines contain two space-separated words:  An option name
and a corresponding value.  If the \fIvalue\fR contains spaces,
it should be surrounded by double-quotes.  Double-quotes within the
value may be escaped with a backslash, as in C.

.SH The GLOBAL Section

The global section, introduced by the \fBglobal\fR keyword, defines
options applicable to the entire daemon.  The available options are:

.TP
\fBo\fR listen-port
The UDP port on which the daemon listens.  By default, the standard UDP
port 1701 is used.

.TP
\fBo\fR load-handler \fIhandler_name\fR
Causes the daemon to dynamically-load a module which extends its functionality.
The available modules are \fIsync-pppd.so\fR, an interface to the Linux
pppd daemon, and \fIcmd.so\fR, a simple command-processor for controlling
the daemon.  These handlers will be described in later sections.

.SH The PEER Section

The peer section, introduced by the \fBsection peer\fR line, has
the following options.  Note that each set of peer options \fImust\fR
be preceded by its own \fBsection peer\fR line.

.TP
\fBo\fR peer \fIaddr\fR
Specifies the IP address of the peer.  It may be an actual IP address
in dotted-quad notation, or a host name.

.TP
\fBo\fR secret \fIshared_secret\fR
Specifies the shared secret to use for tunnel authentication with the peer.
If you omit this option, tunnel authentication is not performed.

.TP
\fBo\fR port \fIport\fR
Specifies the UDP port for contacting the peer.  If the peer contacts
us first, we use whichever port the peer used.

.TP
\fBo\fR lac-handler \fImodule_name\fR
Specifies the name of the module which implements LAC functionality.
In most cases, this should be \fBsync-pppd\fR.  If you omit this option,
then the daemon will not act as a LAC for the peer.

.TP
\fBo\fR lns-handler \fImodule_name\fR
Specifies the name of the module which implements LNS functionality.
In most cases, this should be \fBsync-pppd\fR.  If you omit this option,
then the daemon will not act as a LNS for the peer.

.TP
\fBo\fR hide-avps \fIbool\fR
If \fIbool\fR is 0, we will not hide any AVP's.  If it is 1, we will
hide all the AVP's for which hiding is permitted.  If there is no
shared secret, no AVP's are hidden.

.TP
\fBo\fR retain-tunnel \fIbool\fR
If \fIbool\fR is 0, then the tunnel will be torn down when the last
session terminates.  If it is 1, the tunnel will be maintained even
if there are no sessions.

.TP
\fBo\fR strict-ip-check \fIbool\fR
By default, the l2tp code will discard datagrams for a given tunnel
if the source address does not match the specified peer's IP address.
If you set strict-ip-check to 0, then the l2tp code will accept
datagrams for a tunnel regardless of the source IP address.

.SH The SYNC-PPPD Section

NOTE: The sync-pppd handler only works on Linux.  You must have pppd version
2.4.1 or later, and your kernel must have these modules loaded (or compiled
in): ppp_synctty, ppp_generic, slhc and n_hdlc.

This section is available only if you have used \fBload-handler sync-pppd.so\fR
in the global section.  Options available are:

.TP
\fBo\fR lns-pppd-opts \fIoptions\fR
Options to supply to pppd when we are acting as an LNS.

.TP
\fBo\fR lac-pppd-opts \fIoptions\fR
Options to supply to pppd when we are acting as an LAC.

.TP
\fBo\fR set-ppp-if-name \fIbool\dR
If this is set to 1, then each PPP interface is named with the process-ID
of the pppd process.  For example, if pppd has process-ID 3211, then the
corresponding interface is called ppp3211.  If you set this to 0 (the default),
then the kernel picks the interface name starting at ppp0.

.TP
\fBo\fR pppd-path \fIpath\fR
Sets the path to the pppd program.  If this option is not supplied, the
default path of \fI/usr/sbin/pppd\fR is used.

.PP
Note that the \fBsync-pppd\fR module does not directly support maintaining
a pool of IP addresses for IP address assignment.  We recommend that you
assign IP addresses using a RADIUS server and the latest PPP implementation
from CVS.

.PP
Even if you do not supply any options to sync-pppd, you \fImust\fR have
a \fBsection sync-pppd\fR line to activate the handler.

.SH The CMD Section
This section is available only if you have used \fBload-handler cmd.so\fR
in the global section.  The only option available is:

.TP
\fBo\fR socket-path \fIpathname\fR
Specifies the path name of the UNIX-domain socket for controlling the
daemon.  Defaults to \fI/var/run/l2tpctrl\fR.

.PP
Even if you do not supply any options to cmd, you \fImust\fR have
a \fBsection cmd\fR line to activate the handler.

.SH CONTROLLING THE DAEMON

If you load the \fBcmd.so\fR handler, you can control the daemon
with a special program called \fBl2tp-control\fR.  Here are the
available commands:

.TP
\fBo\fR l2tp-control "exit"
Causes the daemon to terminate all sessions and tunnels, and exit.

.TP
\fBo\fR l2tp-control "start-session \fIpeer\fR"
Causes the daemon to start a session with the specified peer.
The tunnel ID and session ID are printed if the session is successfully
started.

.TP
\fBo\fR l2tp-control "stop-session \fItunnel_id\fR \fIsession_id\fR"
Terminates the specified session.

.TP
\fBo\fR l2tp-control "dump-sessions"
Dumps a list of sessions to standard-output.




.SH AUTHORS
\fBl2tpd\fR was written by David F. Skoll <dfs@roaringpenguin.com>.

